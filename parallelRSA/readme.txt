This is multicore and multithread algorithm
